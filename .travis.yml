sudo: false
dist: trusty
language: python
python:
  - "3.6"

install:
  - pip install fonttools
  - pip install https://github.com/doconce/preprocess/archive/master.zip
  - pip install fontbakery
  - wget https://github.com/felipesanches/FontForge-Debian-Packaging/raw/e523e431b41e1a10a74d2d952d00dcfa43d50dd3/fforge.tar.gz
  - wget https://github.com/felipesanches/FontForge-Debian-Packaging/raw/e523e431b41e1a10a74d2d952d00dcfa43d50dd3/libs.tar.gz
  - tar xvzf fforge.tar.gz
  - sudo mv libs.tar.gz /
  - pushd /
  - sudo tar xvzf libs.tar.gz
  - popd
  - sudo mv /usr/lib/fforge/* /usr/lib/

script:
  - export PYTHONPATH=/usr/lib/python3.6/site-packages
  - make otf
  - make check
  - export DISABLE=" -x com.google.fonts/check/035" # ftxvalidator
  - export DISABLE="$DISABLE -x com.google.fonts/check/054" # only applies to TTF fonts
  - export DISABLE="$DISABLE -x com.google.fonts/check/056" # only applies to TTF fonts
  - export FB_OPTIONS="$DISABLE -l FAIL --no-progress"
  - fontbakery check-googlefonts LibertinusSans-*.otf $FB_OPTIONS

